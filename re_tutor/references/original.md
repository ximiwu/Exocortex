

<details class="note"> 
<summary>切比雪夫多项式与 Minimax 加速：历史对话精华笔记</summary> 
<div markdown="1">


> 目标：把对话里零散的“为什么/凭什么”串成一条清晰的逻辑链，方便复习切比雪夫（Chebyshev）多项式在 Minimax 设计与半迭代加速中的作用。

## 0. 背景：我们到底在优化什么？

在切比雪夫半迭代（Chebyshev semi-iteration）分析里，核心是把“迭代误差”写成一个**多项式滤波器**：

- 基础迭代（示意）：一次迭代可以写成某个线性算子作用在当前向量上；在经典线性分析里常写作迭代矩阵  

$$
G := B^{-1}C.
$$

- 误差传播：若 $x$ 为不动点（精确解），误差 $e^{(k)}=x^{(k)}-x$ 满足  

$$
e^{(k)} = G^k e^{(0)}.
$$

- 加速想法：用历史迭代的线性组合构造加速序列 $y^{(k)}$，其误差等价于  

$$
y^{(k)}-x = p_k(G)\,e^{(0)},
$$

其中 $p_k$ 是 $k$ 次多项式（误差滤波多项式）。

于是设计问题变成：已知（或估计）$G$ 的特征值落在区间 $[-\rho,\rho]$（$\rho\in(0,1)$ 为谱半径界/谱界），如何选 $p_k$ 让区间内的最大放大因子最小，并满足一致性约束（例如 $p_k(1)=1$）？

对应的 Minimax 目标可写为：

$$
\min_{p_k,\;p_k(1)=1}\ \max_{\lambda\in[-\rho,\rho]} |p_k(\lambda)|.
$$

对话的核心结论是：这个问题的最优解由切比雪夫多项式给出（论文写作 $C_k$，数学标准常写作第一类切比雪夫多项式 $T_k$）：

$$
p_k(\lambda)=\frac{T_k(\lambda/\rho)}{T_k(1/\rho)}.
$$

---

## 1. 数学工具：第一类切比雪夫多项式 $T_k$（论文记作 $C_k$）

### 1.1 三角定义（“真身”）

在标准区间 $t\in[-1,1]$ 上：

$$
T_k(t) = \cos\!\big(k\arccos t\big).
$$

令 $t=\cos\theta$（$\theta\in[0,\pi]$），则

$$
T_k(\cos\theta)=\cos(k\theta).
$$

这解释了它为什么“像余弦波一样震荡”。

补充：当 $|t|>1$ 时，$T_k(t)$ 进入快速增长区，可写成双曲形式（用来理解“分母变大带来加速”）：

$$
T_k(t)=\cosh\!\big(k\,\operatorname{arcosh} t\big),\quad t>1.
$$

### 1.2 递推定义（“计算形态”）与其来源

切比雪夫多项式满足三项递推：

$$
T_0(t)=1,\quad T_1(t)=t,\quad T_{k+1}(t)=2t\,T_k(t)-T_{k-1}(t).
$$

为什么成立？把三角定义代入 $t=\cos\theta$，用恒等式

$$
\cos((k+1)\theta)+\cos((k-1)\theta)=2\cos\theta\cos(k\theta)
$$

即可得到递推。

### 1.3 为什么 $T_k(t)=\cos(k\arccos t)$ 真的是 $k$ 次多项式？

有两种等价思路（对话里都用到了）：

1. **用递推归纳**：递推式从 $T_0=1$、$T_1=t$ 出发，每次由“乘 $t$ 再线性组合”生成，次数每步最多加 1，因此 $T_k$ 是 $k$ 次多项式。
2. **用 $\cos(k\theta)$ 的多倍角结构**：$\cos(k\theta)$ 可以写成 $\cos\theta$ 的多项式，从而 $T_k(\cos\theta)$ 对 $\cos\theta$ 是多项式。

### 1.4 最高次项系数为什么是 $2^{k-1}$？

由递推 $T_{k+1}=2tT_k-T_{k-1}$ 可知最高次项每步都被 $2t$ 放大一次，因此当 $k\ge 1$ 时，

$$
T_k(t)=2^{k-1}t^k+\cdots
$$

最高次项系数为 $2^{k-1}$。

---

## 2. “等波纹/等振荡（Equi-ripple）”与“交错触顶”

### 2.1 严格描述（避免口语误解）

在区间 $I$ 上，若函数 $g$ 存在一组点 $x_0<\dots<x_m$，使得
- $|g(x_i)|=\max_{x\in I}|g(x)|=:M$，且
- $g(x_i)=(-1)^i M$（符号交替），

则称 $g$ 在这些点上**交错触顶/等波纹（equioscillation）**。

对 $T_k$ 在 $[-1,1]$ 上：$M=1$，并且存在 $k+1$ 个这样的触顶点（见下一节），因此它呈现典型的“等波纹”形状。

### 2.2 “$x^k$ 也在 $[-1,1]$ 内，能算只震荡一次的等波纹吗？”

不能。关键差别不在“是否被 $[-1,1]$ 夹住”，而在“是否出现**足够多**的交错触顶点”：

- 对一个 $k$ 次多项式，能够实现的“交错触顶点”数量上限是 $k+1$（直观上：次数越高，越能来回摆动更多次）。
- $T_k$ 做到了在 $[-1,1]$ 上 **$k+1$ 次交错触顶**，把“最大误差”均匀分摊到整个区间。
- $x^k$ 在 $[-1,1]$ 上通常是单调或只有端点触顶，不会出现 $k+1$ 个交错触顶点，因此不满足 equioscillation 的判据。

---

## 3. 为什么 $T_k$ 在 $[-1,1]$ 上有 $k+1$ 个极值点？

用三角定义一行看穿：

- 令 $t=\cos\theta$，$\theta\in[0,\pi]$，则 $T_k(\cos\theta)=\cos(k\theta)$。
- $\cos(k\theta)$ 在 $[0,\pi]$ 上会在

$$
\theta_j=\frac{j\pi}{k},\quad j=0,1,\dots,k
$$

处交替达到 $\pm 1$（这就是极值点）。
- 映射回 $t$ 轴：

$$
t_j=\cos\!\left(\frac{j\pi}{k}\right),\quad T_k(t_j)=(-1)^j.
$$

因此在 $[-1,1]$ 上恰有 $k+1$ 个交错触顶的极值点。

---

## 4. Minimax 性质：为什么必须“固定最高次项系数/首一”，以及切比雪夫不等式在做什么？

### 4.1 为什么要固定最高次项系数？

如果不固定最高次项系数，那么任何多项式都可以整体乘一个很小的常数，让 $\max_{[-1,1]}|p|$ 任意小，问题会变成平凡的“缩放游戏”。

因此逼近论里常用两种等价的“规范化”方式：

- 固定最高次项系数为 $2^{k-1}$：比较所有形如 $P(t)=2^{k-1}t^k+\cdots$ 的 $k$ 次多项式；
- 或固定最高次项系数为 1（**首一/monic**）：比较所有 $p(t)=t^k+\cdots$ 的 $k$ 次多项式。

两者只差一个常数因子；因为 $T_k$ 的最高次项系数是 $2^{k-1}$，它的首一版本是

$$
\widetilde{T}_k(t)=2^{1-k}T_k(t).
$$

### 4.2 “切比雪夫不等式”在逼近什么？

这里的“切比雪夫不等式”（多项式版）本质是在给出一个**下界**：同阶（同最高次项系数）多项式在 $[-1,1]$ 上“最多能有多扁”。

典型表述之一是：

- 对任意首一 $k$ 次多项式 $p(t)=t^k+\cdots$，都有

$$
\max_{t\in[-1,1]}|p(t)|\ \ge\ 2^{1-k},
$$

且等号由 $\widetilde{T}_k(t)=2^{1-k}T_k(t)$ 取到。

所以它不是在逼近某个具体函数，而是在说明：**最小可能的最大偏离**是多少；切比雪夫多项式达到这个下界，因此是 minimax 最优。

### 4.3 证明套路（对话精华：数根法/反证法）

证明 minimax/唯一性时反复用同一个“数根”结构：

1. 假设存在另一个同规范化条件的多项式 $P$，其最大模严格更小；
2. 构造差 $D=T_k-P$。由于最高次项系数相同，$D$ 的次数降为 $\le k-1$；
3. 在 $T_k$ 的 $k+1$ 个交错触顶点上，$D$ 的符号必然交替；
4. 符号交替 $\Rightarrow$ 区间内至少有 $k$ 个零点；
5. $\le k-1$ 次多项式不可能有 $k$ 个不同零点，矛盾；从而得到最优性与唯一性。

---

## 5. 切比雪夫交错定理（Chebyshev Alternation Theorem）

### 5.1 定理（最佳一致逼近的判据）

设 $f$ 是 $[a,b]$ 上连续函数，用次数 $\le n$ 的多项式 $P_n$ 去逼近 $f$，并使一致误差 $\|f-P_n\|_\infty$ 最小。

则 $P_n$ 是最佳一致逼近的充要条件之一（经典表述）是：误差

$$
E(x)=f(x)-P_n(x)
$$

在区间上至少存在 $n+2$ 个**交错点**。

### 5.2 交错点的严谨定义

一组点 $x_0<\dots<x_{n+1}$ 称为交错点，若存在 $M=\|E\|_\infty$，使得

$$
E(x_i)=(-1)^i M,\quad i=0,1,\dots,n+1.
$$

（即误差在这些点上等幅触顶且符号交替。）

### 5.3 定理里的 $n$ 到底是谁？

- **通用定义**：$n$ 是“用来逼近的多项式的最高次数”（工具的次数），不是目标函数的次数。
- **本对话的特殊场景**：我们经常把“首一 $k$ 次多项式 minimax”改写为“用 $k-1$ 次多项式逼近 $x^k$”——此时工具次数 $n=k-1$，所以需要的交错点数是 $(k-1)+2=k+1$。

### 5.4 为什么有时是 $k+1$，有时是 $k+2$？

关键在“自由度/约束”：

- 若是在“所有次数 $\le k$”的多项式空间里做最佳一致逼近，空间维度是 $k+1$，交错定理给出 $k+2$ 个交错点。
- 但当你固定最高次项系数（首一）或加上 $p(1)=1$ 之类约束时，自由度减少，相当于在更小维度的空间里优化，于是交错点数量相应减少（常见到 $k+1$）。
- 另外，若问题在 $[-1,1]$ 上具有对称性（奇偶性），可能出现“简并”：实际最优解会拥有**多于定理下限**的交错点。

---

## 6. 从 Minimax（式 7）到闭式解（式 8）：正向推导 + 唯一性

### 6.1 正向推导（构造性思路，不是“瞎猜”）

1. **区间标准化**：令 $t=\lambda/\rho\in[-1,1]$，并定义 $q_k(t)=p_k(\rho t)$。  
这样 Minimax 问题搬运到标准区间 $[-1,1]$ 上。
2. **确定形状**：在 $[-1,1]$ 上，想让最大模最小，就需要一个能“等幅交错触顶”的多项式形状；$T_k(t)$ 正好满足 $|T_k(t)|\le 1$ 且在 $k+1$ 个点交错触顶。
3. **满足约束（归一化）**：为了满足 $p_k(1)=1$（等价地 $q_k(1/\rho)=1$，注意 $1/\rho>1$），对 $T_k$ 做缩放：

$$
q_k^*(t)=\frac{T_k(t)}{T_k(1/\rho)}.
$$

代回得到

$$
p_k(\lambda)=q_k^*(\lambda/\rho)=\frac{T_k(\lambda/\rho)}{T_k(1/\rho)}.
$$

若采用论文记号 $C_k$，则把 $T_k$ 替换为 $C_k$ 即可。

### 6.2 为什么它会“加速”？

这里分子/分母的角色非常清晰：

- 对 $\lambda\in[-\rho,\rho]$，有 $t=\lambda/\rho\in[-1,1]$，因此 $|T_k(t)|\le 1$（分子被“夹住”）。
- 但 $1/\rho>1$ 落在 $|t|>1$ 的增长区，$|T_k(1/\rho)|$ 会随 $k$ 快速增大（近似指数级）。

所以

$$
\max_{\lambda\in[-\rho,\rho]}|p_k(\lambda)| \approx \frac{1}{|T_k(1/\rho)|}
$$

会随着 $k$ 很快变小，这就是加速的数学根源。

### 6.3 唯一性（对话给出的“数根法”一招鲜）

设 $p_k^*$ 为上面的切比雪夫解。若存在另一个同样满足约束的 $p_k$，并且在 $[-\rho,\rho]$ 上最大模严格更小，则差

$$
D(\lambda)=p_k^*(\lambda)-p_k(\lambda)
$$

会在 $p_k^*$ 的 $k+1$ 个交错触顶点上符号交替，从而在 $[-\rho,\rho]$ 内至少有 $k$ 个根；同时又有 $D(1)=0$ 作为额外根（且 $1\notin[-\rho,\rho]$）。这迫使 $D$ 有 $k+1$ 个根，但 $D$ 的次数 $\le k$，只能推出 $D\equiv 0$，即 $p_k\equiv p_k^*$。因此最优解唯一。

---

## 7. 常见疑问补充（对话后段）

### 7.1 “能不能用 $k-1$ 次逼近 $k+1$ 次？”

- 一般来说可以做“最佳一致逼近”，但通常无法精确等于目标高次多项式。
- 在对称区间 $[-1,1]$ 上，最佳逼近常保留目标函数的**奇偶性**：逼近偶函数时最优逼近多项式会是偶多项式；逼近奇函数时同理。  
这会导致某些“次数看起来更高”的项（奇偶性不匹配）最优系数为 0，从而出现“允许到 $k$ 次”和“只允许到 $k-1$ 次（同奇偶）”给出同一最优解的现象（对称性导致的简并）。

### 7.2 论文里有没有显式做“抛弃 $x^k$”？

没有。对话中提到的“相减消去最高次项”（看起来像“抛弃某一项”）主要发生在数学证明里，用于：

- 证明切比雪夫多项式的 minimax 性质；
- 或把“首一 $k$ 次多项式最小最大模”改写为“用 $k-1$ 次逼近 $x^k$”的等价视角。

论文/实现通常直接使用切比雪夫闭式解及其递推性质，把理论转成短递推更新，而不会在代码里显式执行“消去某一项”的代数操作。

---

## 8. 与实现的连接（只保留最小必要映射）

切比雪夫加速的理论是“多项式 $p_k(G)$”，但实现并不显式计算 $p_k$ 的系数。利用切比雪夫递推，可把它化为只需保留两步状态的向量递推（记号与参考文件一致）：

1. 做一次基础迭代步：

$$
x_{\text{tmp}} := B^{-1}(C y^{(i)} + b).
$$

2. 用标量权重混合两步状态：

$$
y^{(i+1)} := (1-\omega_{i+1})\,y^{(i-1)} + \omega_{i+1}\,x_{\text{tmp}}.
$$

权重 $\omega_i$ 可由 $\rho$ 做纯标量递推获得（参考文件给出的实现写法是 $\omega_1=1$，$\omega_2=\frac{1}{1-\rho^2/4}$，随后用 $\omega_{i+1}=\frac{2}{2-\rho^2\omega_i}$ 更新）；当 $\rho\to 1$ 时需注意数值稳定与发散风险。


</div> 
</details>

